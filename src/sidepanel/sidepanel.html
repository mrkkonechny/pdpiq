<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>pdpIQ</title>
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <img src="../../icons/tribbute-logo.png" alt="Tribbute" class="header-logo">
      <h1>pdpIQ</h1>
      <div class="page-info" id="pageInfo">
        <span class="page-domain" id="pageDomain">-</span>
      </div>
    </header>

    <!-- Context Selector (shown before analysis) -->
    <section id="contextSelector" class="context-selector">
      <h2>Select Consumer Context</h2>
      <p class="context-description">How would a consumer typically approach this product?</p>
      <div class="context-options">
        <button class="context-btn" data-context="want">
          <!-- Heart: emotional / lifestyle-driven -->
          <svg class="context-icon" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <circle cx="18" cy="18" r="18" fill="#fce7f3"/>
            <path d="M18 26C17 25 9 20 9 14.5C9 11.5 11.3 9 14 9C15.9 9 17.2 10 18 11.5C18.8 10 20.1 9 22 9C24.7 9 27 11.5 27 14.5C27 20 19 25 18 26Z" fill="#db2777"/>
          </svg>
          <strong>Want</strong>
          <span class="context-hint">Emotional, lifestyle-driven</span>
        </button>
        <button class="context-btn" data-context="need">
          <!-- Lightning bolt: functional / spec-driven -->
          <svg class="context-icon" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <circle cx="18" cy="18" r="18" fill="#dbeafe"/>
            <path d="M21 8L13 20H19L15 28L25 16H19L21 8Z" fill="#1d4ed8"/>
          </svg>
          <strong>Need</strong>
          <span class="context-hint">Functional, spec-driven</span>
        </button>
        <button class="context-btn" data-context="hybrid">
          <!-- Yin-yang: balanced consideration -->
          <svg class="context-icon" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <circle cx="18" cy="18" r="18" fill="#f3f4f6"/>
            <circle cx="18" cy="18" r="10" fill="#ede9fe"/>
            <path d="M18 8 A10 10 0 0 1 18 28 A5 5 0 0 0 18 18 A5 5 0 0 1 18 8 Z" fill="#7c3aed"/>
            <circle cx="18" cy="13" r="2.5" fill="#ede9fe"/>
            <circle cx="18" cy="23" r="2.5" fill="#7c3aed"/>
          </svg>
          <strong>Hybrid</strong>
          <span class="context-hint">Balanced consideration</span>
        </button>
      </div>
    </section>

    <!-- Loading State -->
    <section id="loadingState" class="loading hidden">
      <div class="spinner"></div>
      <p>Analyzing page...</p>
      <p class="loading-hint">Extracting structured data, meta tags, and content...</p>
    </section>

    <!-- Results -->
    <section id="results" class="results hidden">
      <!-- Overall Score -->
      <div class="score-card">
        <div class="grade-container">
          <div class="grade" id="gradeDisplay">-</div>
        </div>
        <div class="score-details">
          <div class="score-value"><span id="scoreValue">0</span><span class="score-max">/100</span></div>
          <div class="context-label" id="contextLabel">-</div>
          <div class="grade-description" id="gradeDescription">-</div>
        </div>
      </div>

      <!-- Category Breakdown -->
      <div class="section-header">
        <h3>Category Scores</h3>
      </div>
      <div class="categories" id="categoryList">
        <!-- Dynamically populated -->
      </div>

      <!-- Recommendations -->
      <div class="section-header">
        <h3>Recommendations</h3>
        <span class="rec-count" id="recCount">0</span>
      </div>
      <div class="recommendations" id="recommendationList">
        <!-- Dynamically populated -->
      </div>

      <!-- Actions -->
      <div class="actions">
        <button id="reanalyzeBtn" class="btn btn-secondary">
          Re-analyze with Different Context
        </button>
      </div>
    </section>

    <!-- Error State -->
    <section id="errorState" class="error-state hidden">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h3>Analysis Error</h3>
      <p id="errorMessage">Unable to analyze this page.</p>
      <button id="retryBtn" class="btn btn-primary">Try Again</button>
    </section>

    <!-- History View -->
    <section id="historySection" class="history-section hidden">
      <div class="section-header">
        <h3>Recent Analyses</h3>
        <button id="clearHistoryBtn" class="btn-icon" title="Clear History">üóëÔ∏è</button>
      </div>
      <div id="historyList" class="history-list">
        <!-- Dynamically populated -->
      </div>
      <div id="emptyHistory" class="empty-state hidden">
        <p>No analyses yet. Click the extension icon on a product page to get started.</p>
      </div>
    </section>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <button class="nav-btn active" data-tab="results">
        <!-- Bar chart -->
        <svg class="nav-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="2" y="11" width="4" height="7" rx="1" fill="currentColor" opacity="0.35"/>
          <rect x="8" y="6" width="4" height="12" rx="1" fill="currentColor"/>
          <rect x="14" y="3" width="4" height="15" rx="1" fill="currentColor" opacity="0.35"/>
        </svg>
        <span class="nav-label">Results</span>
      </button>
      <button class="nav-btn" data-tab="history">
        <!-- Clock -->
        <svg class="nav-icon" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <circle cx="10" cy="10" r="7.5" stroke="currentColor" stroke-width="1.5" opacity="0.35"/>
          <path d="M10 6V10.5L13 12.5" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="nav-label">History</span>
      </button>
    </nav>
  </div>

  <script src="sidepanel.js" type="module"></script>
</body>
</html>
